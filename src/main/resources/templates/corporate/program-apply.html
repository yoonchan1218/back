<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>프로그램 등록 | TRY-CATCH</title>
    <link rel="stylesheet" href="/css/corporate/header.css">
    <link rel="stylesheet" href="/css/corporate/footer.css">
    <link rel="stylesheet" href="/css/corporate/program-regist.css">
    <link rel="stylesheet" href="/css/corporate/program-apply-photo.css">
    <link rel="stylesheet" href="https://cdn.ckeditor.com/ckeditor5/47.4.0/ckeditor5.css">
</head>

<body>
    <div th:replace="~{corporate/header :: header}"></div>
    <div class="page-wrapper">
        <!-- Main Container -->
        <main class="main-container">
            <div class="content-wrapper">
                <form class="register-form" id="recruitForm" method="post" th:action="@{/corporate/program-apply}" enctype="multipart/form-data">

                    <!-- Section 0: 프로그램 제목 -->
                    <section class="form-section" id="titleSection">
                        <div class="section-header">
                            <p class="section-header__title">프로그램 제목을 입력해주세요.</p>
                        </div>
                        <div class="form-content">
                            <div class="form-row">
                                <div class="form-row__label">
                                    <label class="label label--required">프로그램 제목
                                        <span class="label-inner-span labae-icon">필수</span>
                                    </label>
                                </div>
                                <div class="form-row__content">
                                    <input type="text" class="input-field" name="experienceProgramTitle" placeholder="프로그램 제목을 입력해 주세요" maxlength="100" required>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Section 1: 모집요강 -->
                    <section class="form-section" id="jobSection">
                        <div class="section-header">
                            <p class="section-header__title">어떤 포지션을 채용하시나요?</p>
                        </div>
                        <div class="form-content">
                            <!-- 직무 -->
                            <div class="form-row">
                                <div class="form-row__label">
                                    <label class="label label--required">직무
                                        <span class="label-inner-span labae-icon">필수</span>
                                    </label>
                                </div>

                                <div class="input-search">
                                    <input type="text" class="input-search__field" name="experienceProgramJob" placeholder="직무를 입력해 주세요">
                                </div>
                            </div>

                            <!-- 체험단계 -->
                            <div class="form-row" style="margin-top: 44px;">
                                <div class="form-row__label" style="top: 0;">
                                    <label class="label label--required">체험단계
                                        <span class="label-inner-span labae-icon">필수</span>
                                    </label>
                                </div>
                                <div class="form-row__content" style="line-height: 22px; margin-top: 13px;">
                                    <div class="checkbox-group">
                                        <div class="inpBx">
                                            <span class="inpRadio_ui devErrorElWrap">
                                                <input type="radio" class="devFrmJobType" name="experienceProgramLevel" id="lb_job_type_code_1" value="A">
                                                <label for="lb_job_type_code_1">A</label>
                                            </span>
                                            <span class="inpRadio_ui devErrorElWrap">
                                                <input type="radio" class="devFrmJobType" name="experienceProgramLevel" id="lb_job_type_code_2" value="B">
                                                <label for="lb_job_type_code_2">B</label>
                                            </span>
                                            <span class="inpRadio_ui devErrorElWrap">
                                                <input type="radio" class="devFrmJobType" name="experienceProgramLevel" id="lb_job_type_code_3" value="C">
                                                <label for="lb_job_type_code_3">C</label>
                                            </span>
                                            <span class="inpRadio_ui devErrorElWrap">
                                                <input type="radio" class="devFrmJobType" name="experienceProgramLevel" id="lb_job_type_code_4" value="D">
                                                <label for="lb_job_type_code_4">D</label>
                                            </span>
                                            <span class="inpRadio_ui devErrorElWrap">
                                                <input type="radio" class="devFrmJobType" name="experienceProgramLevel" id="lb_job_type_code_5" value="E">
                                                <label for="lb_job_type_code_5">E</label>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 모집인원 -->
                            <div class="form-row" style="margin-top: 44px;">
                                <div class="form-row__label radio-top">
                                    <h4 class="radio-title">모집인원</h4>
                                </div>
                                <div class="form-row__content">
                                    <div class="radio-group">
                                        <div class="inpBx">
                                            <div class="selfBx">
                                                <span class="inpTxItem size_small ac">
                                                    <input type="text" id="recruitmentCount" name="experienceProgramRecruitmentCount" class="devNumberOnly" title="모집인원 직접입력" maxlength="3" value="1" style="width:50px">
                                                </span>
                                                <span class="tx">명</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Section 2: 체험조건 -->
                    <section class="form-section" id="workingSection">
                        <div class="section-header">
                            <h2 class="section-header__title">체험조건을 입력해주세요.</h2>
                        </div>

                        <div class="form-content">
                            <!-- 체험지 주소 -->
                            <div class="form-row">
                                <div class="form-row__label" style="top: 7px;">
                                    <label class="label label--required">체험지 주소
                                        <span class="label-inner-span labae-icon">필수</span>
                                    </label>
                                </div>
                                <div class="form-row__content">
                                    <input type="text" id="address" class="input-field" placeholder="주소를 검색하려면 클릭하세요" readonly>
                                    <input type="text" id="detailAddress" class="input-field" placeholder="상세주소를 입력하세요" style="margin-top: 10px; display: none;">
                                    <input type="hidden" name="addressZipcode" id="addressZipcode">
                                    <input type="hidden" name="addressAddress" id="addressAddress">
                                    <input type="hidden" name="addressDetail" id="addressDetailHidden">
                                </div>
                            </div>
                            <!-- 체험요일 -->
                            <div class="form-row">
                                <div class="form-row__label">
                                    <label class="radio-title">체험요일</label>
                                </div>
                                <div class="form-row__content">
                                    <div class="date-range-input">
                                        <div class="input-field-wrap">
                                            <input type="date" class="input-field input-field--date" id="workday-start">
                                        </div>
                                        <span class="date-separator">~</span>
                                        <div class="input-field-wrap">
                                            <input type="date" class="input-field input-field--date" id="workday-end">
                                        </div>
                                    </div>
                                    <input type="hidden" name="experienceProgramWorkDays" id="workDaysHidden">
                                </div>
                            </div>

                            <!-- 체험시간 -->
                            <div class="form-row">
                                <div class="form-row__label">
                                    <label class="radio-title">체험시간</label>
                                </div>
                                <div class="form-row__content">
                                    <div class="time-input-group">
                                        <select class="select-field select-field--small" id="workStartHour">
                                            <option value="">시</option>
                                            <option value="00">00</option><option value="01">01</option><option value="02">02</option>
                                            <option value="03">03</option><option value="04">04</option><option value="05">05</option>
                                            <option value="06">06</option><option value="07">07</option><option value="08">08</option>
                                            <option value="09" selected>09</option><option value="10">10</option><option value="11">11</option>
                                            <option value="12">12</option><option value="13">13</option><option value="14">14</option>
                                            <option value="15">15</option><option value="16">16</option><option value="17">17</option>
                                            <option value="18">18</option><option value="19">19</option><option value="20">20</option>
                                            <option value="21">21</option><option value="22">22</option><option value="23">23</option>
                                        </select>
                                        <select class="select-field select-field--small" id="workStartMin">
                                            <option value="">분</option>
                                            <option value="00" selected>00</option><option value="10">10</option>
                                            <option value="20">20</option><option value="30">30</option>
                                            <option value="40">40</option><option value="50">50</option>
                                        </select>
                                        <span class="time-separator">~</span>
                                        <select class="select-field select-field--small" id="workEndHour">
                                            <option value="">시</option>
                                            <option value="00">00</option><option value="01">01</option><option value="02">02</option>
                                            <option value="03">03</option><option value="04">04</option><option value="05">05</option>
                                            <option value="06">06</option><option value="07">07</option><option value="08">08</option>
                                            <option value="09">09</option><option value="10">10</option><option value="11">11</option>
                                            <option value="12">12</option><option value="13">13</option><option value="14">14</option>
                                            <option value="15">15</option><option value="16">16</option><option value="17">17</option>
                                            <option value="18" selected>18</option><option value="19">19</option><option value="20">20</option>
                                            <option value="21">21</option><option value="22">22</option><option value="23">23</option>
                                        </select>
                                        <select class="select-field select-field--small" id="workEndMin">
                                            <option value="">분</option>
                                            <option value="00" selected>00</option><option value="10">10</option>
                                            <option value="20">20</option><option value="30">30</option>
                                            <option value="40">40</option><option value="50">50</option>
                                        </select>
                                    </div>
                                    <input type="hidden" name="experienceProgramWorkHours" id="workHoursHidden">
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Section 3: 접수방법 -->
                    <section class="form-section" id="applySection">
                        <div class="section-header">
                            <h2 class="section-header__title">접수기간과 방법을 선택해주세요.</h2>
                        </div>

                        <div class="form-content">
                            <!-- 접수마감일 -->
                            <div class="form-row">
                                <div class="form-row__label">
                                    <label class="label label--required">접수마감일
                                        <span class="label-inner-span labae-icon">필수</span>
                                    </label>
                                </div>
                                <div class="form-row__content">
                                    <input type="date" class="input-field input-field--date" id="deadline" name="experienceProgramDeadline" required>
                                </div>
                            </div>
                            <!-- 제출서류 -->
                            <div class="form-row">
                                <div class="form-row__label" style="top: 0px;">
                                    <label class="label label--required">제출서류
                                        <span class="label-inner-span labae-icon">필수</span>
                                    </label>
                                </div>
                                <div class="form-row__content">
                                    <div class="checkbox-group" style="display: flex;">
                                        <span class="inpChk_ui">
                                            <input type="checkbox" id="lb_doc_01" value="자기소개서" checked disabled>
                                            <label for="lb_doc_01">자기소개서</label>
                                        </span>
                                    </div>
                                </div>
                            </div>

                            <!-- 인사담당자 -->
                            <div class="form-row">
                                <div class="form-row__label">
                                    <label class="label label--required">인사담당자
                                        <span class="label-inner-span labae-icon">필수</span>
                                    </label>
                                </div>
                                <div class="form-row__content">
                                    <div class="managerModified" id="devGuinManager">
                                        <div class="managerFormArea">
                                            <div class="mngFormRow">
                                                <strong class="titMngField point">이름<span class="label-inner-span labae-icon">필수</span></strong>
                                                <div class="mngInpBx">
                                                    <span class="inpTxItem devErrorElWrap">
                                                        <input class="inpMngInfo_1" style="width:200px;" title="담당자 이름" type="text" th:value="${loginMember?.memberName}" readonly>
                                                    </span>
                                                </div>
                                            </div>

                                            <div class="mngFormRow">
                                                <strong class="titMngField point">전화번호<span class="label-inner-span labae-icon">필수</span></strong>
                                                <div class="mngInpBx">
                                                    <span class="inpTxItem devErrorElWrap">
                                                        <input class="inpMngInfo_1" style="width:200px;" title="전화번호" type="text" th:value="${corpInfo?.memberPhone}" readonly>
                                                    </span>
                                                </div>
                                            </div>

                                            <div class="mngFormRow">
                                                <strong class="titMngField point">이메일<span class="label-inner-span labae-icon">필수</span></strong>
                                                <div class="mngInpBx">
                                                    <span class="inpTxItem devErrorElWrap">
                                                        <input class="inpMngInfo_3" style="width:200px;" title="이메일" type="text" th:value="${corpInfo?.memberEmail}" readonly>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                        <p class="mngFormTxt">* 인사 담당자 정보는 공고에 노출되지 않으며, 매니저와의 소통 목적으로 사용됩니다.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Section 4: 공고 사진 첨부 -->
                    <section class="form-section" id="photoSection">
                        <div class="section-header">
                            <h2 class="section-header__title">프로그램 사진을 등록해주세요.</h2>
                        </div>
                        <div class="form-content">
                            <div class="form-row">
                                <div class="form-row__label" style="top: 0;">
                                    <label class="label">프로그램 사진
                                        <span class="label-inner-span" style="color:#999;">선택</span>
                                    </label>
                                </div>
                                <div class="form-row__content">
                                    <div class="photo-upload-area">
                                        <div class="photo-upload-box" id="photoUploadBox">
                                            <div class="photo-upload-placeholder" id="photoPlaceholder">
                                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#adb5bd" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                                    <polyline points="21 15 16 10 5 21"></polyline>
                                                </svg>
                                                <p class="photo-upload-text">클릭하거나 파일을 드래그하여 업로드</p>
                                                <p class="photo-upload-hint">JPG, PNG, GIF (최대 5MB, 최대 5장)</p>
                                            </div>
                                            <input type="file" id="photoInput" name="programFiles" multiple accept="image/*" style="display:none;">
                                        </div>
                                        <div class="photo-preview-list" id="photoPreviewList">
                                            <!-- 미리보기 이미지들이 JS로 추가됨 -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Section 5: 상세요강 -->
                    <div class="regSec regEditSec" id="DetailCntntSection">
                        <h3 class="skip">상세요강</h3>
                        <div class="regNotice">
                            <h4 class="regNotice-title">잠깐! 공고 등록 시 꼭 확인해 주세요!</h4>
                            <ul class="regNotice-list">
                                <li class="regNotice-item">- 채험절차 공정화에 관한 법률에 따라 직무 수행과 상관없는 신체조건, 출신 지역, 재산 등의 개인정보를 요구, 수집하는 경우 <strong>500만 원 이하의 과태료가 부과될</strong> 수 있습니다.</li>
                                <li class="regNotice-item">- 합리적 이유 없이 성별 제한 또는 연령 제한을 하는 경우 관련 법령에 따라 과태료가 부과될 수 있습니다.</li>
                                <li class="regNotice-item">- 상세요강에 '고수익' '고소득' 으로 구직자를 현혹하는 내용이 포함된 공고는 <strong>사전 고지 없이 마감/삭제 될 수</strong> 있습니다.</li>
                            </ul>
                        </div>

                        <div class="regEditAreaWrap">
                            <div class="regEditArea">
                                <div class="regEditWrap">
                                    <textarea name="experienceProgramDescription" id="editor" rows="10" cols="100" style="width:100%; height:700px; display:block;"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <div class="save-container">
        <div class="save-bar-wrap">
            <div class="save-bar-inner">
                <div class="save-bar-buttons">
                    <button type="submit" form="recruitForm" class="Form-Submit-button">등록완료</button>
                </div>
            </div>
        </div>
    </div>

    <div th:replace="~{corporate/footer :: footer}"></div>

</body>
<!-- 새로고침 방지 -->
<script>
    let isSubmitting = false;
    window.addEventListener('beforeunload', function(e) {
        if (isSubmitting) return;
        e.preventDefault();
        e.returnValue = '';
    });
    document.getElementById('recruitForm').addEventListener('submit', function(e) {
        const title = document.querySelector('input[name="experienceProgramTitle"]');
        const job = document.querySelector('input[name="experienceProgramJob"]');
        const level = document.querySelector('input[name="experienceProgramLevel"]:checked');
        const deadline = document.getElementById('deadline');

        if (!title.value.trim()) {
            alert('프로그램 제목을 입력해주세요.');
            title.focus();
            e.preventDefault();
            return;
        }
        if (!job.value.trim()) {
            alert('직무를 입력해주세요.');
            job.focus();
            e.preventDefault();
            return;
        }
        if (!level) {
            alert('체험단계를 선택해주세요.');
            e.preventDefault();
            return;
        }
        if (!deadline.value) {
            alert('접수마감일을 선택해주세요.');
            deadline.focus();
            e.preventDefault();
            return;
        }

        const today = new Date().toISOString().split('T')[0];
        const workdayStart = document.getElementById('workday-start');
        const workdayEnd = document.getElementById('workday-end');

        if (deadline.value < today) {
            alert('접수마감일은 오늘 이후여야 합니다. 다시 입력해주세요.');
            deadline.focus();
            e.preventDefault();
            return;
        }
        if (workdayStart.value && workdayStart.value < today) {
            alert('체험요일 시작일은 오늘 이후여야 합니다. 다시 입력해주세요.');
            workdayStart.focus();
            e.preventDefault();
            return;
        }
        if (workdayEnd.value && workdayEnd.value < today) {
            alert('체험요일 종료일은 오늘 이후여야 합니다. 다시 입력해주세요.');
            workdayEnd.focus();
            e.preventDefault();
            return;
        }
        if (deadline.value && workdayStart.value && deadline.value >= workdayStart.value) {
            alert('접수마감일은 체험요일 시작일보다 이전이어야 합니다. 다시 입력해주세요.');
            deadline.focus();
            e.preventDefault();
            return;
        }

        isSubmitting = true;
    });
</script>
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script src="/js/corporate/program-apply/event.js"></script>
<script src="https://cdn.ckeditor.com/ckeditor5/47.4.0/ckeditor5.umd.js"></script>
<script src="/js/corporate/program-apply/editor-init.js"></script>
<script src="/js/corporate/program-apply/photo-upload.js"></script>

</html>
