<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.app.trycatch.mapper.mypage.ApplyListMapper">

    <!-- 회원의 체험 지원 목록 조회 (취소 제외) -->
    <select id="selectAllByMemberId" resultType="ApplyListDTO">
        SELECT
            a.id                            AS applyId,
            a.experience_program_id,
            a.apply_status,
            a.created_datetime              AS applyCreatedDatetime,
            ep.experience_program_title,
            ep.experience_program_job,
            ep.experience_program_deadline,
            ep.experience_program_status,
            c.corp_company_name
        FROM tbl_apply a
        LEFT JOIN tbl_experience_program ep ON a.experience_program_id = ep.id
        LEFT JOIN tbl_corp c ON ep.corp_id = c.id
        WHERE a.member_id = #{memberId}
          AND a.apply_status != 'cancelled'
        ORDER BY a.created_datetime DESC
    </select>

</mapper>
